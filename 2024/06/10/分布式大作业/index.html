<!DOCTYPE html>

<html lang="zh-CN">

<head>
    
    <title>分布式大作业 - Amentiraz blog</title>
    <meta charset="UTF-8">
    <meta name="description" content="">
    <meta name="keywords" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5">
    
    

    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />
    <meta name="description" content="配环境比写代码难一万倍QAQ">
<meta property="og:type" content="article">
<meta property="og:title" content="分布式大作业">
<meta property="og:url" content="http://1152396492.github.io/2024/06/10/%E5%88%86%E5%B8%83%E5%BC%8F%E5%A4%A7%E4%BD%9C%E4%B8%9A/index.html">
<meta property="og:site_name" content="Amentiraz blog">
<meta property="og:description" content="配环境比写代码难一万倍QAQ">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://www.oracle.com/java/technologies/javase/javase-jdk8-downloads.html">
<meta property="og:image" content="https://www.python.org/ftp/python/3.6.3/python-3.6.3-amd64.exe">
<meta property="og:image" content="http://1152396492.github.io/2024/06/10/%E5%88%86%E5%B8%83%E5%BC%8F%E5%A4%A7%E4%BD%9C%E4%B8%9A/1.png">
<meta property="article:published_time" content="2024-06-10T14:23:11.000Z">
<meta property="article:modified_time" content="2024-06-14T03:05:45.166Z">
<meta property="article:author" content="Amentiraz">
<meta property="article:tag" content="代码">
<meta property="article:tag" content="分布式">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://www.oracle.com/java/technologies/javase/javase-jdk8-downloads.html">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/combine/npm/highlight.js@9.15.8/styles/atom-one-dark.css,npm/justifiedGallery@3.8.1/dist/css/justifiedGallery.min.css,gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css,npm/hexo-theme-nexmoe@latest/source/lib/mdui_043tiny/css/mdui.css,npm/hexo-theme-nexmoe@latest/source/lib/iconfont/iconfont.css?v=233" crossorigin>
    <link rel="stylesheet" href="/css/style.css?v=1718334421734">
    
    <link rel="stylesheet" href="/lib/iconfont/iconfont.css?v=1718334421734">
<meta name="generator" content="Hexo 6.0.0"></head>

<body class="mdui-drawer-body-left">
    
    <div id="nexmoe-background">
        <div class="nexmoe-bg" style="background-image: url(https://i.postimg.cc/XNHkwZh8/wallhaven-pkw6y3.jpg)"></div>
        <div class="mdui-appbar mdui-shadow-0">
            <div class="mdui-toolbar">
                <a mdui-drawer="{target: '#drawer', swipe: true}" title="menu" class="mdui-btn mdui-btn-icon mdui-ripple"><i class="mdui-icon nexmoefont icon-menu"></i></a>
                <div class="mdui-toolbar-spacer"></div>
                <!--<a href="javascript:;" class="mdui-btn mdui-btn-icon"><i class="mdui-icon material-icons">search</i></a>-->
                <a href="/" title="Amentiraz" class="mdui-btn mdui-btn-icon"><img src="https://i.postimg.cc/P5FyTCbJ/20220606230333.jpg" alt="Amentiraz"></a>
            </div>
        </div>
    </div>
    <div id="nexmoe-header">
        <div class="nexmoe-drawer mdui-drawer" id="drawer">
    <div class="nexmoe-avatar mdui-ripple">
        <a href="/" title="Amentiraz">
            <img src="https://i.postimg.cc/P5FyTCbJ/20220606230333.jpg" alt="Amentiraz" alt="Amentiraz">
        </a>
    </div>
    <div class="nexmoe-count">
        <div><span>文章</span>29</div>
        <div><span>标签</span>28</div>
        <div><span>分类</span>6</div>
    </div>
    <div class="nexmoe-list mdui-list" mdui-collapse="{accordion: true}">
        
        <a class="nexmoe-list-item mdui-list-item mdui-ripple false" href="/" title="回到首页">
            <i class="mdui-list-item-icon nexmoefont icon-home"></i>
            <div class="mdui-list-item-content">
                回到首页
            </div>
        </a>
        
        <a class="nexmoe-list-item mdui-list-item mdui-ripple false" href="/about.html" title="关于博客">
            <i class="mdui-list-item-icon nexmoefont icon-info-circle"></i>
            <div class="mdui-list-item-content">
                关于博客
            </div>
        </a>
        
        <a class="nexmoe-list-item mdui-list-item mdui-ripple false" href="/PY.html" title="我的朋友">
            <i class="mdui-list-item-icon nexmoefont icon-unorderedlist"></i>
            <div class="mdui-list-item-content">
                我的朋友
            </div>
        </a>
        
        <a class="nexmoe-list-item mdui-list-item mdui-ripple false" href="/archive.html" title="文章归档">
            <i class="mdui-list-item-icon nexmoefont icon-container"></i>
            <div class="mdui-list-item-content">
                文章归档
            </div>
        </a>
        
    </div>
    <aside id="nexmoe-sidebar">
    
    <div class="nexmoe-widget-wrap">
    <div class="nexmoe-widget nexmoe-search">
         
            <form id="search_form" action_e="https://cn.bing.com/search?q=site:nexmoe.com" onsubmit="return search();">
                <label><input id="search_value" name="q" type="search" placeholder="搜索"></label>
            </form>
         
    </div>
</div>
    
    <div class="nexmoe-widget-wrap">
    <div class="nexmoe-widget nexmoe-social">
        <a class="mdui-ripple" href="https://jq.qq.com/?_wv=1027&k=5CfKHun" target="_blank" mdui-tooltip="{content: 'QQ群'}" style="color: rgb(249, 174, 8);background-color: rgba(249, 174, 8, .1);">
            <i class="nexmoefont icon-QQ"></i>
        </a><a class="mdui-ripple" href="https://space.bilibili.com/20238211" target="_blank" mdui-tooltip="{content: '哔哩哔哩'}" style="color: rgb(231, 106, 141);background-color: rgba(231, 106, 141, .15);">
            <i class="nexmoefont icon-bilibili"></i>
        </a><a class="mdui-ripple" href="https://github.com/nexmoe/" target="_blank" mdui-tooltip="{content: 'GitHub'}" style="color: rgb(25, 23, 23);background-color: rgba(25, 23, 23, .15);">
            <i class="nexmoefont icon-github"></i>
        </a>
    </div>
</div>
    
    
  <div class="nexmoe-widget-wrap">
    <h3 class="nexmoe-widget-title">文章分类</h3>
    <div class="nexmoe-widget">

      <ul class="category-list">

        


        

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/代码/">代码</a>
          <span class="category-list-count">3</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/学习笔记/">学习笔记</a>
          <span class="category-list-count">5</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/数学建模/">数学建模</a>
          <span class="category-list-count">4</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/生活/">生活</a>
          <span class="category-list-count">9</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/算法/">算法</a>
          <span class="category-list-count">6</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/论文/">论文</a>
          <span class="category-list-count">1</span>
        </li>

        
      </ul>

    </div>
  </div>


    
    
  <div class="nexmoe-widget-wrap">
    <div id="randomtagcloud" class="nexmoe-widget tagcloud nexmoe-rainbow">
      <a href="/tags/C%E8%AF%AD%E8%A8%80/" style="font-size: 15px;">C语言</a> <a href="/tags/DP/" style="font-size: 10px;">DP</a> <a href="/tags/Dijkstra/" style="font-size: 10px;">Dijkstra</a> <a href="/tags/LCA/" style="font-size: 10px;">LCA</a> <a href="/tags/Matlab/" style="font-size: 10px;">Matlab</a> <a href="/tags/TOPSIS/" style="font-size: 12.5px;">TOPSIS</a> <a href="/tags/Tarjan/" style="font-size: 10px;">Tarjan</a> <a href="/tags/c%E8%AF%AD%E8%A8%80/" style="font-size: 10px;">c语言</a> <a href="/tags/python/" style="font-size: 10px;">python</a> <a href="/tags/%E4%B9%A6%E8%AF%84/" style="font-size: 15px;">书评</a> <a href="/tags/%E4%BB%A3%E7%A0%81/" style="font-size: 15px;">代码</a> <a href="/tags/%E5%88%86%E5%B8%83%E5%BC%8F/" style="font-size: 15px;">分布式</a> <a href="/tags/%E5%A4%8D%E4%B9%A0%E8%B5%84%E6%96%99/" style="font-size: 10px;">复习资料</a> <a href="/tags/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" style="font-size: 15px;">学习笔记</a> <a href="/tags/%E5%B1%82%E6%AC%A1%E5%88%86%E6%9E%90%E6%B3%95/" style="font-size: 10px;">层次分析法</a> <a href="/tags/%E6%8C%87%E9%92%88/" style="font-size: 10px;">指针</a> <a href="/tags/%E6%8F%92%E5%80%BC%E7%AE%97%E6%B3%95/" style="font-size: 10px;">插值算法</a> <a href="/tags/%E6%95%B0%E5%AD%A6%E5%BB%BA%E6%A8%A1/" style="font-size: 17.5px;">数学建模</a> <a href="/tags/%E6%9D%82/" style="font-size: 10px;">杂</a> <a href="/tags/%E7%94%9F%E6%B4%BB/" style="font-size: 20px;">生活</a> <a href="/tags/%E7%AC%94%E8%AE%B0/" style="font-size: 10px;">笔记</a> <a href="/tags/%E7%AE%97%E6%B3%95/" style="font-size: 20px;">算法</a> <a href="/tags/%E7%BA%BF%E6%AE%B5%E6%A0%91/" style="font-size: 10px;">线段树</a> <a href="/tags/%E7%BB%93%E6%9E%84/" style="font-size: 10px;">结构</a> <a href="/tags/%E8%AE%BA%E6%96%87/" style="font-size: 10px;">论文</a> <a href="/tags/%E8%AF%97/" style="font-size: 10px;">诗</a> <a href="/tags/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/" style="font-size: 10px;">读书笔记</a> <a href="/tags/%E9%A2%98%E8%A7%A3/" style="font-size: 10px;">题解</a>
    </div>
    
  </div>

    
</aside>
    <div class="nexmoe-copyright">
        &copy; 2024 Amentiraz
        Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
        & <a href="https://github.com/theme-nexmoe/hexo-theme-nexmoe" target="_blank">Nexmoe</a>
        <br><a target="_blank" href="https://www.upyun.com/?utm_source=lianmeng&utm_medium=referral"><img src="https://i.dawnlab.me/c0268c1e6cfd0863d6ba35be1575941a.png" width="150px"></a><script data-ad-client="ca-pub-2058306854838448" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    </div>
</div><!-- .nexmoe-drawer -->
    </div>
    <div id="nexmoe-content">
        <div class="nexmoe-primary">
            <div class="nexmoe-post">

  <article>
      
          <div class="nexmoe-post-cover" style="padding-bottom: 66.66666666666666%;"> 
              <img data-src="https://i.postimg.cc/XNHkwZh8/wallhaven-pkw6y3.jpg" data-sizes="auto" alt="分布式大作业" class="lazyload">
              <h1>分布式大作业</h1>
          </div>
      
      
      <div class="nexmoe-post-meta nexmoe-rainbow" style="margin:10px 0!important;">
    <a><i class="nexmoefont icon-calendar-fill"></i>2024年06月10日</a>
    <a><i class="nexmoefont icon-areachart"></i>3.7k 字</a>
    <a><i class="nexmoefont icon-time-circle-fill"></i>大概 20 分钟</a>
</div>

      

      <p>配环境比写代码难一万倍QAQ</p>
<span id="more"></span>
<p>不要使用Docker配置多节点环境！</p>
<p>不要使用Docker配置多节点环境！</p>
<p>不要使用Docker配置多节点环境！</p>
<p>如果你要使用docker请使用老师给的第二个pdf文件上的方案也就是配置单节点的环境。这个方案是可行的。但我并没有走这个方案，因为配多节点的时候我的系统环境产生了不可名状的变化，导致我配置单节点时仍然报错，所以这篇博客是针对本地配置Hadoop的文章</p>
<p>在整个问题中，你会遇到非常多次的需要下载老版本的情况，请认准release archives字样，它会带你去旧版本的下载界面，你会遇到多种多样的报错，请在报错时尝试清空namenode和datanode里面的文件重新配置。</p>
<h1 id="环境配置遇到的问题及解决方案"><a href="#环境配置遇到的问题及解决方案" class="headerlink" title="环境配置遇到的问题及解决方案"></a>环境配置遇到的问题及解决方案</h1><h2 id="无法解压tar-gz文件？"><a href="#无法解压tar-gz文件？" class="headerlink" title="无法解压tar.gz文件？"></a>无法解压tar.gz文件？</h2><p>在<strong>打开管理员模式的命令提示符</strong>中，使用指令tar -zxvf fileName.tar.gz</p>
<h2 id="NodeManager启动时遇到错误"><a href="#NodeManager启动时遇到错误" class="headerlink" title="NodeManager启动时遇到错误"></a>NodeManager启动时遇到错误</h2><p>NodeManager启动时遇到了一个java.lang.ExceptionInInitializerError<br>原因是JAVA版本太高了，我用的是java22，请重新下载JAVA8即1.8的版本<br>GPT解释：特别是Java 9及其以上版本引入了模块系统（Jigsaw项目），导致一些反射操作变得不可访问。而许多Hadoop的库和依赖项（比如Guice和CGLIB）在设计时没有考虑到这些新的限制<br><img data-fancybox="gallery" data-sizes="auto" data-src="https://www.oracle.com/java/technologies/javase/javase-jdk8-downloads.html" alt="JAVA1.8下载地址" class="lazyload"></p>
<h2 id="pyspark指令报错"><a href="#pyspark指令报错" class="headerlink" title="pyspark指令报错"></a>pyspark指令报错</h2><p>你的Python版本太高了<br>我这里直接采用了老师的那个版本<br><img data-fancybox="gallery" data-sizes="auto" data-src="https://www.python.org/ftp/python/3.6.3/python-3.6.3-amd64.exe" alt="python3.6.3" class="lazyload"></p>
<h2 id="卡在running-job后不动了"><a href="#卡在running-job后不动了" class="headerlink" title="卡在running job后不动了"></a>卡在running job后不动了</h2><p>修改xml里面的配置，包括yarn-site、hdfs-site、core-site、mapred-site，后面会给出我的配置和详细的信息。</p>
<h1 id="环境配置"><a href="#环境配置" class="headerlink" title="环境配置"></a>环境配置</h1><p>Hadoop 3.0.0<br>python 3.6.3<br>Java 1.8<br>maven 3.9.7<br>系统变量：<img src="/2024/06/10/%E5%88%86%E5%B8%83%E5%BC%8F%E5%A4%A7%E4%BD%9C%E4%B8%9A/1.png"></p>
<p>我的主机名是LAPTOP-1A91HHJ4,如果你要查看自己的主机名可在命令指示符中输入’hostname’，即可得到主机名</p>
<h2 id="core-site-yml"><a href="#core-site-yml" class="headerlink" title="core-site.yml"></a>core-site.yml</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs xml"><br><span class="hljs-meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="hljs-meta">&lt;?xml-stylesheet type=&quot;text/xsl&quot; href=&quot;configuration.xsl&quot;?&gt;</span><br><span class="hljs-comment">&lt;!--</span><br><span class="hljs-comment">  Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</span><br><span class="hljs-comment">  you may not use this file except in compliance with the License.</span><br><span class="hljs-comment">  You may obtain a copy of the License at</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">    http://www.apache.org/licenses/LICENSE-2.0</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">  Unless required by applicable law or agreed to in writing, software</span><br><span class="hljs-comment">  distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span><br><span class="hljs-comment">  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span><br><span class="hljs-comment">  See the License for the specific language governing permissions and</span><br><span class="hljs-comment">  limitations under the License. See accompanying LICENSE file.</span><br><span class="hljs-comment">--&gt;</span><br><br><span class="hljs-comment">&lt;!-- Put site-specific property overrides in this file. --&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">configuration</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">property</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>fs.defaultFS<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span>hdfs://localhost:9000<span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">configuration</span>&gt;</span><br></code></pre></td></tr></table></figure>

<h2 id="hdfs-site-yml"><a href="#hdfs-site-yml" class="headerlink" title="hdfs-site.yml"></a>hdfs-site.yml</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs xml"><br><span class="hljs-meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="hljs-meta">&lt;?xml-stylesheet type=&quot;text/xsl&quot; href=&quot;configuration.xsl&quot;?&gt;</span><br><span class="hljs-comment">&lt;!--</span><br><span class="hljs-comment">  Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</span><br><span class="hljs-comment">  you may not use this file except in compliance with the License.</span><br><span class="hljs-comment">  You may obtain a copy of the License at</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">    http://www.apache.org/licenses/LICENSE-2.0</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">  Unless required by applicable law or agreed to in writing, software</span><br><span class="hljs-comment">  distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span><br><span class="hljs-comment">  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span><br><span class="hljs-comment">  See the License for the specific language governing permissions and</span><br><span class="hljs-comment">  limitations under the License. See accompanying LICENSE file.</span><br><span class="hljs-comment">--&gt;</span><br><br><span class="hljs-comment">&lt;!-- Put site-specific property overrides in this file. --&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">configuration</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">property</span>&gt;</span><br>       <span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>dfs.replication<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span><br>       <span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span>1<span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span><br>   <span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">property</span>&gt;</span><br>       <span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>dfs.namenode.name.dir<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span><br>       <span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span>file:///C:/Hadoop/data/namenode<span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span><br>   <span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">property</span>&gt;</span><br>       <span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>dfs.datanode.data.dir<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span><br>       <span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span>file:///C:/Hadoop/data/datanode<span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span><br>   <span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">property</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>dfs.namenode.http-address<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span>LAPTOP-1A91HHJ4:9089<span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">property</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>dfs.datanode.http.address<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span>LAPTOP-1A91HHJ4:9088<span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">configuration</span>&gt;</span><br></code></pre></td></tr></table></figure>

<h2 id="yarn-site"><a href="#yarn-site" class="headerlink" title="yarn-site"></a>yarn-site</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><code class="hljs xml"><br><span class="hljs-meta">&lt;?xml version=&quot;1.0&quot;?&gt;</span><br><span class="hljs-comment">&lt;!--</span><br><span class="hljs-comment">  Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</span><br><span class="hljs-comment">  you may not use this file except in compliance with the License.</span><br><span class="hljs-comment">  You may obtain a copy of the License at</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">    http://www.apache.org/licenses/LICENSE-2.0</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">  Unless required by applicable law or agreed to in writing, software</span><br><span class="hljs-comment">  distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span><br><span class="hljs-comment">  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span><br><span class="hljs-comment">  See the License for the specific language governing permissions and</span><br><span class="hljs-comment">  limitations under the License. See accompanying LICENSE file.</span><br><span class="hljs-comment">--&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">configuration</span>&gt;</span><br><br><span class="hljs-comment">&lt;!-- Site specific YARN configuration properties --&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">property</span>&gt;</span><br>    	<span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>yarn.nodemanager.aux-services<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span><br>    	<span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span>mapreduce_shuffle<span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span><br>   <span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">property</span>&gt;</span><br>      	<span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>yarn.nodemanager.auxservices.mapreduce.shuffle.class<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span>  <br>    <span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span>org.apache.hadoop.mapred.ShuffleHandler<span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span><br>   <span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">property</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>yarn.resourcemanager.hostname<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span>LAPTOP-1A91HHJ4<span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">property</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>yarn.resourcemanager.bind-host<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span>0.0.0.0<span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">property</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>yarn.nodemanager.resource.memory-mb<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span>20480<span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span> <span class="hljs-comment">&lt;!-- 根据你的集群配置调整 --&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">property</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>yarn.scheduler.minimum-allocation-mb<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span>2048<span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span> <span class="hljs-comment">&lt;!-- 根据你的集群配置调整 --&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">property</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>yarn.nodemanager.resource.cpu-vcores<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span>4<span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span> <span class="hljs-comment">&lt;!-- 根据你的集群配置调整 --&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">property</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>yarn.nodemanager.vmem-pmem-ratio<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span>2.1<span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">property</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>yarn.scheduler.maximum-allocation-vcores<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span>4<span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span> <span class="hljs-comment">&lt;!-- 根据你的集群配置调整 --&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">property</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>yarn.resourcemanager.address<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span>LAPTOP-1A91HHJ4:8032<span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">property</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>yarn.resourcemanager.scheduler.address<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span>LAPTOP-1A91HHJ4:8030<span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">property</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>yarn.resourcemanager.resource-tracker.address<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span>LAPTOP-1A91HHJ4:8031<span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">property</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>yarn.resourcemanager.admin.address<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span>LAPTOP-1A91HHJ4:8033<span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">property</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>yarn.resourcemanager.webapp.address<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span>LAPTOP-1A91HHJ4:8088<span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">configuration</span>&gt;</span><br></code></pre></td></tr></table></figure>

<h2 id="mapred-site"><a href="#mapred-site" class="headerlink" title="mapred-site"></a>mapred-site</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs xml"><br><span class="hljs-meta">&lt;?xml version=&quot;1.0&quot;?&gt;</span><br><span class="hljs-meta">&lt;?xml-stylesheet type=&quot;text/xsl&quot; href=&quot;configuration.xsl&quot;?&gt;</span><br><span class="hljs-comment">&lt;!--</span><br><span class="hljs-comment">  Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</span><br><span class="hljs-comment">  you may not use this file except in compliance with the License.</span><br><span class="hljs-comment">  You may obtain a copy of the License at</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">    http://www.apache.org/licenses/LICENSE-2.0</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">  Unless required by applicable law or agreed to in writing, software</span><br><span class="hljs-comment">  distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span><br><span class="hljs-comment">  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span><br><span class="hljs-comment">  See the License for the specific language governing permissions and</span><br><span class="hljs-comment">  limitations under the License. See accompanying LICENSE file.</span><br><span class="hljs-comment">--&gt;</span><br><br><span class="hljs-comment">&lt;!-- Put site-specific property overrides in this file. --&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">configuration</span>&gt;</span><br>    <span class="hljs-comment">&lt;!--</span><br><span class="hljs-comment">    &lt;property&gt;</span><br><span class="hljs-comment">    &lt;name&gt;mapreduce.framework.name&lt;/name&gt;</span><br><span class="hljs-comment">    &lt;value&gt;yarn&lt;/value&gt;</span><br><span class="hljs-comment">    &lt;/property&gt;--&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">property</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>mapreduce.job.tracker<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span>hdfs://LAPTOP-1A91HHJ4:8001<span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">final</span>&gt;</span>true<span class="hljs-tag">&lt;/<span class="hljs-name">final</span>&gt;</span><br> <span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">property</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>mapreduce.jobhistory.address<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span>LAPTOP-1A91HHJ4:10020<span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">property</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>mapreduce.jobhistory.webapp.address<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span>LAPTOP-1A91HHJ4:19888<span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">configuration</span>&gt;</span><br></code></pre></td></tr></table></figure>
<p>由于我走了很多的弯路，可能这上面的配置多了很多不必要的东西，但一定是可以跑通的。</p>
<p>如果遇到了类似端口占用的报错请直接删除它，例如报错：Port in use:0.0.0.0:8042,首先检查占用端口的进程：<br>‘netstat -ano | findstr :8042’<br>找到他的进程ID，输入指令:’taskill &#x2F;PID yourIdNum &#x2F;F’即可</p>
<h1 id="问题重述"><a href="#问题重述" class="headerlink" title="问题重述"></a>问题重述</h1><p>一 实验目的<br>1.	学习基于MapReduce框架的分布式计算程序设计方法。<br>2.	学习基于Spark框架的分布式计算程序设计方法。<br>二 实验题目<br>题目1<br>输入文件为学生成绩信息，包含了必修课与选修课成绩，格式如下：<br>班级1, 姓名1, 科目1, 必修, 成绩1 ‘<br>‘ （注：’<br>‘ 为换行符）<br>班级2, 姓名2, 科目1, 必修, 成绩2 ‘<br>‘<br>班级1, 姓名1, 科目2, 选修，成绩3 ‘<br>‘<br>………., ………, ………, ………   ‘<br>‘</p>
<p>编写两个Hadoop平台上的MapReduce程序，分别实现如下功能：</p>
<ol>
<li>计算每个学生必修课的平均成绩。</li>
<li>按科目统计每个班的平均成绩。<br>题目2<br>输入文件的每一行为具有父子&#x2F;父女&#x2F;母子&#x2F;母女&#x2F;关系的一对人名，例如：<br>Tim, Andy ‘<br>‘<br>Harry, Alice ‘<br>‘<br>Mark, Louis ‘<br>‘<br>Andy, Joseph ‘<br>‘<br>……….., ………… ‘<br>‘<br>假定不会出现重名现象。<br>编写Hadoop平台上的MapReduce程序，找出所有具有grandchild-grandparent关系的人名组。<br>题目3<br>输入文件为学生成绩信息，包含了必修课与选修课成绩，格式如下：<br>班级1, 姓名1, 科目1, 必修, 成绩1 ‘<br>‘ （注：’<br>‘ 为换行符）<br>班级2, 姓名2, 科目1, 必修, 成绩2 ‘<br>‘<br>班级1, 姓名1, 科目2, 选修，成绩3 ‘<br>‘<br>………., ………, ………, ………   ‘<br>‘<br>编写一个Spark程序，同时实现如下功能：</li>
<li>计算每个学生必修课的平均成绩。</li>
<li>统计学生必修课平均成绩在：90<del>100,80</del>89,70<del>79,60</del>69和60分以下这5个分数段的人数。</li>
</ol>
<h1 id="具体实现"><a href="#具体实现" class="headerlink" title="具体实现"></a>具体实现</h1><h2 id="题目1"><a href="#题目1" class="headerlink" title="题目1"></a>题目1</h2><h3 id="问题1"><a href="#问题1" class="headerlink" title="问题1"></a>问题1</h3><h4 id="配置pom"><a href="#配置pom" class="headerlink" title="配置pom"></a>配置pom</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs xml"><br><span class="hljs-meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">project</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">&quot;http://maven.apache.org/POM/4.0.0&quot;</span></span><br><span class="hljs-tag">         <span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span><br><span class="hljs-tag">         <span class="hljs-attr">xsi:schemaLocation</span>=<span class="hljs-string">&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">modelVersion</span>&gt;</span>4.0.0<span class="hljs-tag">&lt;/<span class="hljs-name">modelVersion</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.ls<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>StuAvg<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.0-SNAPSHOT<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">dependencies</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.apache.hadoop<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>hadoop-client<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>3.3.3<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">dependencies</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">properties</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">maven.compiler.source</span>&gt;</span>22<span class="hljs-tag">&lt;/<span class="hljs-name">maven.compiler.source</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">maven.compiler.target</span>&gt;</span>22<span class="hljs-tag">&lt;/<span class="hljs-name">maven.compiler.target</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">project.build.sourceEncoding</span>&gt;</span>UTF-8<span class="hljs-tag">&lt;/<span class="hljs-name">project.build.sourceEncoding</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">properties</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">build</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">finalName</span>&gt;</span>StuAvg<span class="hljs-tag">&lt;/<span class="hljs-name">finalName</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">build</span>&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">project</span>&gt;</span><br></code></pre></td></tr></table></figure>

<p>剩下的配置文件与之类似，不再赘述</p>
<h4 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h4><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><br>package com.ls;<br><br><span class="hljs-keyword">import</span> org.apache.hadoop.conf.<span class="hljs-keyword">Configuration</span>;<br><span class="hljs-keyword">import</span> org.apache.hadoop.fs.Path;<br><span class="hljs-keyword">import</span> org.apache.hadoop.io.DoubleWritable;<br><span class="hljs-keyword">import</span> org.apache.hadoop.io.LongWritable;<br><span class="hljs-keyword">import</span> org.apache.hadoop.io.Text;<br><span class="hljs-keyword">import</span> org.apache.hadoop.mapreduce.Job;<br><span class="hljs-keyword">import</span> org.apache.hadoop.mapreduce.Mapper;<br><span class="hljs-keyword">import</span> org.apache.hadoop.mapreduce.Reducer;<br><span class="hljs-keyword">import</span> org.apache.hadoop.mapreduce.lib.<span class="hljs-keyword">input</span>.FileInputFormat;<br><span class="hljs-keyword">import</span> org.apache.hadoop.mapreduce.lib.output.FileOutputFormat;<br><br><span class="hljs-keyword">import</span> java.io.IOException;<br><br><span class="hljs-built_in">public</span> <span class="hljs-keyword">class</span> StuAvg &#123;<br><br>    <span class="hljs-built_in">public</span> static <span class="hljs-keyword">class</span> StuMap extends Mapper&lt;LongWritable, <span class="hljs-type">Text</span>, <span class="hljs-type">Text</span>, LongWritable&gt; &#123;<br>        @Override<br>        protected <span class="hljs-type">void</span> map (LongWritable key, <span class="hljs-type">Text</span> <span class="hljs-keyword">value</span>, Context context) throws IOException, InterruptedException &#123;<br>            String <span class="hljs-type">line</span> = <span class="hljs-keyword">value</span>.toString();<br>            String[] field = <span class="hljs-type">line</span>.split(&quot;,&quot;);<br>            <span class="hljs-keyword">if</span> ( field.length == <span class="hljs-number">5</span> &amp;&amp; field[<span class="hljs-number">3</span>].equals(&quot;必修&quot;)) &#123;<br>                String <span class="hljs-type">Name</span> = field[<span class="hljs-number">1</span>] ;<br>                long score = Long.parseLong(field[<span class="hljs-number">4</span>]);<br>                context.<span class="hljs-keyword">write</span>(<span class="hljs-built_in">new</span> Text(<span class="hljs-type">Name</span>), <span class="hljs-built_in">new</span> LongWritable(score));<br>            &#125;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-built_in">public</span> static <span class="hljs-keyword">class</span> StuReduce extends Reducer&lt;<span class="hljs-type">Text</span>, LongWritable, <span class="hljs-type">Text</span>, DoubleWritable&gt; &#123;<br>        @Override<br>        protected <span class="hljs-type">void</span> reduce(<span class="hljs-type">Text</span> key, Iterable&lt;LongWritable&gt; <span class="hljs-keyword">values</span>, Context context) throws IOException, InterruptedException &#123;<br>            long sum = <span class="hljs-number">0</span>;<br>            <span class="hljs-type">int</span> count = <span class="hljs-number">0</span>;<br><br>            <span class="hljs-keyword">for</span> (LongWritable val : <span class="hljs-keyword">values</span>) &#123;<br>                sum += val.<span class="hljs-keyword">get</span>();<br>                count++;<br>            &#125;<br>            <span class="hljs-keyword">if</span> (count &gt; <span class="hljs-number">0</span>) &#123;<br>                <span class="hljs-type">double</span> average = (<span class="hljs-type">double</span>) sum / (<span class="hljs-type">double</span>) count;<br>                context.<span class="hljs-keyword">write</span>(key, <span class="hljs-built_in">new</span> DoubleWritable(average));<br>            &#125;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-built_in">public</span> static <span class="hljs-type">void</span> main(String[] args) throws <span class="hljs-keyword">Exception</span> &#123;<br>        <span class="hljs-keyword">Configuration</span> conf = <span class="hljs-built_in">new</span> <span class="hljs-keyword">Configuration</span>();<br>        Job job = Job.getInstance(conf);<br>        job.setJarByClass(StuMap.<span class="hljs-keyword">class</span>);<br>        job.setMapperClass(StuMap.<span class="hljs-keyword">class</span>);<br>        job.setReducerClass(StuReduce.<span class="hljs-keyword">class</span>);<br>        job.setMapOutputKeyClass(<span class="hljs-type">Text</span>.<span class="hljs-keyword">class</span>);<br>        job.setMapOutputValueClass(LongWritable.<span class="hljs-keyword">class</span>);<br>        job.setOutputKeyClass(<span class="hljs-type">Text</span>.<span class="hljs-keyword">class</span>);<br>        job.setOutputValueClass(DoubleWritable.<span class="hljs-keyword">class</span>);<br><br>        FileInputFormat.setInputPaths(job, <span class="hljs-built_in">new</span> Path(args[<span class="hljs-number">0</span>]));<br>        FileOutputFormat.setOutputPath(job, <span class="hljs-built_in">new</span> Path(args[<span class="hljs-number">1</span>]));<br><br>        <span class="hljs-keyword">System</span>.<span class="hljs-keyword">exit</span>(job.waitForCompletion(<span class="hljs-keyword">true</span>) ? <span class="hljs-number">0</span> : <span class="hljs-number">1</span>);<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure>

<h3 id="问题2"><a href="#问题2" class="headerlink" title="问题2"></a>问题2</h3><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><br>package com.ls;<br><br><span class="hljs-keyword">import</span> org.apache.hadoop.conf.<span class="hljs-keyword">Configuration</span>;<br><span class="hljs-keyword">import</span> org.apache.hadoop.fs.Path;<br><span class="hljs-keyword">import</span> org.apache.hadoop.io.DoubleWritable;<br><span class="hljs-keyword">import</span> org.apache.hadoop.io.LongWritable;<br><span class="hljs-keyword">import</span> org.apache.hadoop.io.Text;<br><span class="hljs-keyword">import</span> org.apache.hadoop.mapreduce.Job;<br><span class="hljs-keyword">import</span> org.apache.hadoop.mapreduce.Mapper;<br><span class="hljs-keyword">import</span> org.apache.hadoop.mapreduce.Reducer;<br><span class="hljs-keyword">import</span> org.apache.hadoop.mapreduce.lib.<span class="hljs-keyword">input</span>.FileInputFormat;<br><span class="hljs-keyword">import</span> org.apache.hadoop.mapreduce.lib.output.FileOutputFormat;<br><br><span class="hljs-keyword">import</span> java.io.IOException;<br><br><span class="hljs-built_in">public</span> <span class="hljs-keyword">class</span> ClassAvg &#123;<br><br>    <span class="hljs-built_in">public</span> static <span class="hljs-keyword">class</span> Map extends Mapper&lt;LongWritable, <span class="hljs-type">Text</span>, <span class="hljs-type">Text</span>, LongWritable&gt; &#123;<br>        @Override<br>        protected <span class="hljs-type">void</span> map (LongWritable key, <span class="hljs-type">Text</span> <span class="hljs-keyword">value</span>, Context context) throws IOException, InterruptedException &#123;<br>            String <span class="hljs-type">line</span> = <span class="hljs-keyword">value</span>.toString();<br>            String[] field = <span class="hljs-type">line</span>.split(&quot;,&quot;);<br>            <span class="hljs-keyword">if</span> ( field.length == <span class="hljs-number">5</span> ) &#123;<br>                String <span class="hljs-type">Name</span> = field[<span class="hljs-number">0</span>]+&quot;_&quot;+field[<span class="hljs-number">2</span>] ;<br>                long score = Long.parseLong(field[<span class="hljs-number">4</span>]);<br>                context.<span class="hljs-keyword">write</span>(<span class="hljs-built_in">new</span> Text(<span class="hljs-type">Name</span>), <span class="hljs-built_in">new</span> LongWritable(score));<br>            &#125;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-built_in">public</span> static <span class="hljs-keyword">class</span> Reduce extends Reducer&lt;<span class="hljs-type">Text</span>, LongWritable, <span class="hljs-type">Text</span>, DoubleWritable&gt; &#123;<br>        @Override<br>        protected <span class="hljs-type">void</span> reduce(<span class="hljs-type">Text</span> key, Iterable&lt;LongWritable&gt; <span class="hljs-keyword">values</span>, Context context) throws IOException, InterruptedException &#123;<br>            long sum = <span class="hljs-number">0</span>;<br>            <span class="hljs-type">int</span> count = <span class="hljs-number">0</span>;<br><br>            <span class="hljs-keyword">for</span> (LongWritable val : <span class="hljs-keyword">values</span>) &#123;<br>                sum += val.<span class="hljs-keyword">get</span>();<br>                count++ ;<br>            &#125;<br><br>            <span class="hljs-type">double</span> average = (<span class="hljs-type">double</span>) sum / (<span class="hljs-type">double</span>) count;<br>            context.<span class="hljs-keyword">write</span>(key, <span class="hljs-built_in">new</span> DoubleWritable(average));<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-built_in">public</span> static <span class="hljs-type">void</span> main(String[] args) throws <span class="hljs-keyword">Exception</span> &#123;<br>        <span class="hljs-keyword">Configuration</span> conf = <span class="hljs-built_in">new</span> <span class="hljs-keyword">Configuration</span>();<br>        Job job = Job.getInstance(conf);<br>        job.setJarByClass(Map.<span class="hljs-keyword">class</span>);<br>        job.setMapperClass(Map.<span class="hljs-keyword">class</span>);<br>        job.setReducerClass(Reduce.<span class="hljs-keyword">class</span>);<br>        job.setMapOutputKeyClass(<span class="hljs-type">Text</span>.<span class="hljs-keyword">class</span>);<br>        job.setMapOutputValueClass(LongWritable.<span class="hljs-keyword">class</span>);<br>        job.setOutputKeyClass(<span class="hljs-type">Text</span>.<span class="hljs-keyword">class</span>);<br>        job.setOutputValueClass(DoubleWritable.<span class="hljs-keyword">class</span>);<br><br>        FileInputFormat.setInputPaths(job, <span class="hljs-built_in">new</span> Path(args[<span class="hljs-number">0</span>]));<br>        FileOutputFormat.setOutputPath(job, <span class="hljs-built_in">new</span> Path(args[<span class="hljs-number">1</span>]));<br><br>        <span class="hljs-keyword">System</span>.<span class="hljs-keyword">exit</span>(job.waitForCompletion(<span class="hljs-keyword">true</span>) ? <span class="hljs-number">0</span> : <span class="hljs-number">1</span>);<br>    &#125;<br>&#125;<br><br><br></code></pre></td></tr></table></figure>

<h2 id="题目2"><a href="#题目2" class="headerlink" title="题目2"></a>题目2</h2><h3 id="代码-1"><a href="#代码-1" class="headerlink" title="代码"></a>代码</h3><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><br>package com.ls;<br><span class="hljs-keyword">import</span> org.apache.hadoop.conf.<span class="hljs-keyword">Configuration</span>;<br><span class="hljs-keyword">import</span> org.apache.hadoop.fs.Path;<br><span class="hljs-keyword">import</span> org.apache.hadoop.io.DoubleWritable;<br><span class="hljs-keyword">import</span> org.apache.hadoop.io.LongWritable;<br><span class="hljs-keyword">import</span> org.apache.hadoop.io.Text;<br><span class="hljs-keyword">import</span> org.apache.hadoop.mapreduce.Job;<br><span class="hljs-keyword">import</span> org.apache.hadoop.mapreduce.Mapper;<br><span class="hljs-keyword">import</span> org.apache.hadoop.mapreduce.Reducer;<br><span class="hljs-keyword">import</span> org.apache.hadoop.mapreduce.lib.<span class="hljs-keyword">input</span>.FileInputFormat;<br><span class="hljs-keyword">import</span> org.apache.hadoop.mapreduce.lib.output.FileOutputFormat;<br><br><span class="hljs-keyword">import</span> java.io.IOException;<br><span class="hljs-keyword">import</span> java.util.ArrayList;<br><span class="hljs-built_in">public</span> <span class="hljs-keyword">class</span> GrandPC &#123;<br>    <span class="hljs-built_in">public</span> static <span class="hljs-keyword">class</span> Map extends Mapper&lt;LongWritable, <span class="hljs-type">Text</span>, <span class="hljs-type">Text</span>, <span class="hljs-type">Text</span>&gt; &#123;<br>        @Override<br>        protected <span class="hljs-type">void</span> map (LongWritable key, <span class="hljs-type">Text</span> <span class="hljs-keyword">value</span>, Context context) throws IOException, InterruptedException &#123;<br>            String <span class="hljs-type">line</span> = <span class="hljs-keyword">value</span>.toString();<br>            String[] names = <span class="hljs-type">line</span>.split(&quot;,&quot;);<br>            String child = names[<span class="hljs-number">0</span>].trim()+&quot;_child&quot;;<br>            String grand = names[<span class="hljs-number">1</span>].trim()+&quot;_parent&quot;;<br>            context.<span class="hljs-keyword">write</span>(<span class="hljs-built_in">new</span> Text(names[<span class="hljs-number">0</span>].trim()), <span class="hljs-built_in">new</span> Text(grand));<br>            context.<span class="hljs-keyword">write</span>(<span class="hljs-built_in">new</span> Text(names[<span class="hljs-number">1</span>].trim()), <span class="hljs-built_in">new</span> Text(child));<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-built_in">public</span> static <span class="hljs-keyword">class</span> Reduce extends Reducer&lt;<span class="hljs-type">Text</span>, <span class="hljs-type">Text</span>, <span class="hljs-type">Text</span>, <span class="hljs-type">Text</span>&gt; &#123;<br>        @Override<br>        protected <span class="hljs-type">void</span> reduce (<span class="hljs-type">Text</span> key, Iterable&lt;<span class="hljs-type">Text</span>&gt; <span class="hljs-keyword">values</span>, Context context) throws IOException, InterruptedException &#123;<br>            String grand = key.toString();<br>            ArrayList&lt;String&gt; parents = <span class="hljs-built_in">new</span> ArrayList&lt;&gt;() ;<br>            ArrayList&lt;String&gt; children = <span class="hljs-built_in">new</span> ArrayList&lt;&gt;() ;<br>            <span class="hljs-keyword">for</span> (<span class="hljs-type">Text</span> <span class="hljs-keyword">value</span> : <span class="hljs-keyword">values</span>) &#123;<br>                String node = <span class="hljs-keyword">value</span>.toString();<br>                String [] <span class="hljs-type">name</span> = node.split(&quot;_&quot;) ;<br>                <span class="hljs-keyword">if</span> ( <span class="hljs-type">name</span>[<span class="hljs-number">1</span>].equals(&quot;child&quot;) ) &#123;<br>                    children.<span class="hljs-keyword">add</span>(<span class="hljs-type">name</span>[<span class="hljs-number">0</span>].trim());<br>                &#125;<br>                <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( <span class="hljs-type">name</span>[<span class="hljs-number">1</span>].equals(&quot;parent&quot;) ) &#123;<br>                    parents.<span class="hljs-keyword">add</span>(<span class="hljs-type">name</span>[<span class="hljs-number">0</span>].trim());<br>                &#125;<br>                <span class="hljs-keyword">else</span> &#123;<br>                    <span class="hljs-keyword">continue</span> ;<br>                &#125;<br>            &#125;<br>            <span class="hljs-keyword">for</span> (String child : children) &#123;<br>                <span class="hljs-keyword">for</span> (String parent : parents) &#123;<br>                    context.<span class="hljs-keyword">write</span>(<span class="hljs-built_in">new</span> Text(child), <span class="hljs-built_in">new</span> Text(parent));<br>                &#125;<br>            &#125;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-built_in">public</span> static <span class="hljs-type">void</span> main(String[] args) throws <span class="hljs-keyword">Exception</span> &#123;<br>        <span class="hljs-keyword">Configuration</span> conf = <span class="hljs-built_in">new</span> <span class="hljs-keyword">Configuration</span>();<br>        Job job = Job.getInstance(conf);<br>        job.setJarByClass(Map.<span class="hljs-keyword">class</span>);<br>        job.setMapperClass(Map.<span class="hljs-keyword">class</span>);<br>        job.setReducerClass(Reduce.<span class="hljs-keyword">class</span>);<br>        job.setMapOutputKeyClass(<span class="hljs-type">Text</span>.<span class="hljs-keyword">class</span>);<br>        job.setMapOutputValueClass(<span class="hljs-type">Text</span>.<span class="hljs-keyword">class</span>);<br>        job.setOutputKeyClass(<span class="hljs-type">Text</span>.<span class="hljs-keyword">class</span>);<br>        job.setOutputValueClass(<span class="hljs-type">Text</span>.<span class="hljs-keyword">class</span>);<br><br>        FileInputFormat.setInputPaths(job, <span class="hljs-built_in">new</span> Path(args[<span class="hljs-number">0</span>]));<br>        FileOutputFormat.setOutputPath(job, <span class="hljs-built_in">new</span> Path(args[<span class="hljs-number">1</span>]));<br><br>        <span class="hljs-keyword">System</span>.<span class="hljs-keyword">exit</span>(job.waitForCompletion(<span class="hljs-keyword">true</span>) ? <span class="hljs-number">0</span> : <span class="hljs-number">1</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<h3 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h3><p>思路是输入的数据例如child,parent，我们将它变为两组输出，一组为child,parentParent,一组为parent,childChild。在map阶段，若对于同一KEY有多个值，我们将值划分为Parent组和Child组一一匹配作为祖先-孩子组输出。</p>
<h2 id="题目3"><a href="#题目3" class="headerlink" title="题目3"></a>题目3</h2><h3 id="代码-2"><a href="#代码-2" class="headerlink" title="代码"></a>代码</h3><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs reasonml"><br># -*- coding: gb18030 -*-<br><br>from pyspark import SparkConf, SparkContext<br><br><br>conf = <span class="hljs-constructor">SparkConf()</span>.set<span class="hljs-constructor">Master(<span class="hljs-string">&quot;local&quot;</span>)</span>.set<span class="hljs-constructor">AppName(<span class="hljs-string">&quot;gradecount&quot;</span>)</span><br>sc = <span class="hljs-constructor">SparkContext(<span class="hljs-params">conf</span> = <span class="hljs-params">conf</span>)</span><br>grades = sc.text<span class="hljs-constructor">File(<span class="hljs-string">&quot;/spark/grades.txt&quot;</span>)</span><br> <br>def f(x):<br>    <span class="hljs-keyword">if</span>(x &gt;= <span class="hljs-number">90</span> <span class="hljs-keyword">and</span> x &lt;= <span class="hljs-number">100</span>):<br>        return (<span class="hljs-string">&quot;90-100&quot;</span>)<br>    <span class="hljs-keyword">if</span>(x &gt;= <span class="hljs-number">80</span> <span class="hljs-keyword">and</span> x &lt; <span class="hljs-number">90</span>):<br>        return (<span class="hljs-string">&quot;80-89&quot;</span>) <br>    <span class="hljs-keyword">if</span>(x &gt;= <span class="hljs-number">70</span> <span class="hljs-keyword">and</span> x &lt; <span class="hljs-number">80</span>):<br>        return (<span class="hljs-string">&quot;70-79&quot;</span>) <br>    <span class="hljs-keyword">if</span>(x &gt;= <span class="hljs-number">60</span> <span class="hljs-keyword">and</span> x &lt; <span class="hljs-number">70</span>):<br>        return (<span class="hljs-string">&quot;60-69&quot;</span>) <br>    <span class="hljs-keyword">if</span>(x &lt; <span class="hljs-number">60</span>):<br>        return (<span class="hljs-string">&quot;0-59&quot;</span>) <br>grades = grades.filter(lambda line: <span class="hljs-string">&quot;必修&quot;</span> <span class="hljs-keyword">in</span> line)<br><br>name_grade_pairs = grades.map(lambda line: (line.split(<span class="hljs-string">&quot;,&quot;</span>)<span class="hljs-literal">[<span class="hljs-number">1</span>]</span>, (<span class="hljs-built_in">int</span>(line.split(<span class="hljs-string">&quot;,&quot;</span>)<span class="hljs-literal">[<span class="hljs-number">4</span>]</span>), <span class="hljs-number">1</span>)))<br># name_grade_pairs.save<span class="hljs-constructor">AsTextFile(<span class="hljs-string">&quot;name_grade_pairs&quot;</span>)</span><br><br>avg_grades = name_grade_pairs.reduce<span class="hljs-constructor">ByKey(<span class="hljs-params">lambda</span> <span class="hljs-params">x1</span>, <span class="hljs-params">x2</span>: (<span class="hljs-params">x1</span>[0] + <span class="hljs-params">x2</span>[0], <span class="hljs-params">x1</span>[1] + <span class="hljs-params">x2</span>[1])</span>).map<span class="hljs-constructor">Values(<span class="hljs-params">lambda</span> <span class="hljs-params">x</span>: <span class="hljs-params">int</span>(<span class="hljs-params">x</span>[0] <span class="hljs-operator">/</span> <span class="hljs-params">x</span>[1])</span>).sort<span class="hljs-constructor">By(<span class="hljs-params">lambda</span> <span class="hljs-params">x</span>: <span class="hljs-params">x</span>[1], <span class="hljs-params">ascending</span>=True)</span><br>avg_grades.save<span class="hljs-constructor">AsTextFile(<span class="hljs-string">&quot;/avg_grades&quot;</span>)</span><br><br>interval_grades = avg_grades.map(lambda x: (f(x<span class="hljs-literal">[<span class="hljs-number">1</span>]</span>), <span class="hljs-number">1</span>))<br>interval_stu_nums = interval_grades.reduce<span class="hljs-constructor">ByKey(<span class="hljs-params">lambda</span> <span class="hljs-params">x</span>, <span class="hljs-params">y</span>: (<span class="hljs-params">x</span> + <span class="hljs-params">y</span>)</span>).sort<span class="hljs-constructor">ByKey()</span><br>interval_stu_nums.save<span class="hljs-constructor">AsTextFile(<span class="hljs-string">&quot;/interval_stu_nums&quot;</span>)</span><br><br></code></pre></td></tr></table></figure>

<h1 id="具体指令"><a href="#具体指令" class="headerlink" title="具体指令"></a>具体指令</h1><h2 id="打开hadoop"><a href="#打开hadoop" class="headerlink" title="打开hadoop"></a>打开hadoop</h2><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-keyword">start</span>-<span class="hljs-keyword">all</span><br></code></pre></td></tr></table></figure>
<h2 id="StuAvg"><a href="#StuAvg" class="headerlink" title="StuAvg"></a>StuAvg</h2><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs jboss-cli">mvn clean<br>mvn package<br><br>hadoop fs -mkdir <span class="hljs-string">/StuAvg</span><br>hadoop fs -put grades.txt <span class="hljs-string">/StuAvg</span><br>hadoop jar <span class="hljs-string">./target/StuAvg.jar</span> com.<span class="hljs-keyword">ls</span>.StuAvg <span class="hljs-string">/StuAvg/grades.txt</span> <span class="hljs-string">/output1</span><br><br>hadoop fs -ls <span class="hljs-string">/output1</span><br>hadoop fs -cat <span class="hljs-string">/output1/part-r-00000</span><br>hadoop fs -rm -r output1<br></code></pre></td></tr></table></figure>
<h2 id="ClassAvg"><a href="#ClassAvg" class="headerlink" title="ClassAvg"></a>ClassAvg</h2><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs jboss-cli">mvn clean<br>mvn package<br><br>hadoop fs -mkdir <span class="hljs-string">/ClassAvg</span><br>hadoop fs -put grades.txt <span class="hljs-string">/ClassAvg</span><br>hadoop jar <span class="hljs-string">./target/ClassAvg.jar</span> com.<span class="hljs-keyword">ls</span>.ClassAvg <span class="hljs-string">/ClassAvg/grades.txt</span> <span class="hljs-string">/output2</span><br><br>hadoop fs -ls <span class="hljs-string">/output2</span><br>hadoop fs -cat <span class="hljs-string">/output2/part-r-00000</span><br>hadoop fs -rm -r output2<br></code></pre></td></tr></table></figure>
<h2 id="GrandPC"><a href="#GrandPC" class="headerlink" title="GrandPC"></a>GrandPC</h2><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs jboss-cli">mvn clean<br>mvn package<br><br>hadoop fs -mkdir <span class="hljs-string">/GrandPC</span><br>hadoop fs -put child-parent.txt <span class="hljs-string">/GrandPC</span><br>hadoop jar <span class="hljs-string">./target/GrandPC.jar</span> com.<span class="hljs-keyword">ls</span>.GrandPC <span class="hljs-string">/GrandPC/child-parent.txt</span> <span class="hljs-string">/output3</span><br><br>hadoop fs -ls <span class="hljs-string">/output3</span><br>hadoop fs -cat <span class="hljs-string">/output3/part-r-00000</span><br>hadoop fs -rm -r output3<br></code></pre></td></tr></table></figure>
<h2 id="Spark"><a href="#Spark" class="headerlink" title="Spark"></a>Spark</h2><figure class="highlight dos"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs dos"><span class="hljs-built_in">start</span>-dfs <br><br>hadoop <span class="hljs-built_in">fs</span> -<span class="hljs-built_in">mkdir</span> /spark<br>hadoop <span class="hljs-built_in">fs</span> -put C:\Users\<span class="hljs-number">11523</span>\Desktop\Spark\grades.txt /spark<br><br>pyspark<br><br>spark-submit Spark.py<br><br>hadoop <span class="hljs-built_in">fs</span> -cat /interval_stu_nums/part-<span class="hljs-number">00000</span><br>hadoop <span class="hljs-built_in">fs</span> -cat /avg_grades/part-<span class="hljs-number">00000</span><br></code></pre></td></tr></table></figure>











  </article>

  
      
    <div class="nexmoe-post-copyright">
        <strong>本文作者：</strong>Amentiraz<br>
        <strong>本文链接：</strong><a href="http://1152396492.github.io/2024/06/10/%E5%88%86%E5%B8%83%E5%BC%8F%E5%A4%A7%E4%BD%9C%E4%B8%9A/" title="http:&#x2F;&#x2F;1152396492.github.io&#x2F;2024&#x2F;06&#x2F;10&#x2F;%E5%88%86%E5%B8%83%E5%BC%8F%E5%A4%A7%E4%BD%9C%E4%B8%9A&#x2F;" target="_blank" rel="noopener">http:&#x2F;&#x2F;1152396492.github.io&#x2F;2024&#x2F;06&#x2F;10&#x2F;%E5%88%86%E5%B8%83%E5%BC%8F%E5%A4%A7%E4%BD%9C%E4%B8%9A&#x2F;</a><br>
        
            <strong>版权声明：</strong>本文采用 <a href="https://creativecommons.org/licenses/by-nc-sa/3.0/cn/deed.zh" target="_blank">CC BY-NC-SA 3.0 CN</a> 协议进行许可
        
    </div>


  
  
  <div class="nexmoe-post-meta nexmoe-rainbow">
    
        <a class="nexmoefont icon-appstore-fill -link" href="/categories/%E4%BB%A3%E7%A0%81/">代码</a>
    
    
        <a class="nexmoefont icon-tag-fill -none-link" href="/tags/%E4%BB%A3%E7%A0%81/" rel="tag">代码</a> <a class="nexmoefont icon-tag-fill -none-link" href="/tags/%E5%88%86%E5%B8%83%E5%BC%8F/" rel="tag">分布式</a>
    
</div>

  
      <div class="nexmoe-post-footer">
          <section class="nexmoe-comment">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@latest/dist/gitalk.min.css">
<div id="gitalk"></div>
<script src="https://cdn.jsdelivr.net/npm/gitalk@latest/dist/gitalk.min.js"></script>
<script type="text/javascript">
    var gitalk = new Gitalk({
        clientID: 'd792bb4144ed2b426d10',
        clientSecret: '812d33a3a53d9f83437ed1e71c573a8b222a93f1',
        id: window.location.pathname,
        repo: '1152396492.github.io',
        owner: '1152396492',
        admin: '1152396492'
    })
    gitalk.render('gitalk')
</script>
</section>
      </div>
  
</div>
            <div class="nexmoe-post-right">
              <div class="nexmoe-fixed">
                  <div class="nexmoe-tool"> 
                    
                      
                        
                          
                          
                              <button class="mdui-fab catalog" style="overflow:unset;">
                                  <i class="nexmoefont icon-i-catalog"></i>
                                  <div class="nexmoe-toc">
                                      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE%E9%81%87%E5%88%B0%E7%9A%84%E9%97%AE%E9%A2%98%E5%8F%8A%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88"><span class="toc-number">1.</span> <span class="toc-text">环境配置遇到的问题及解决方案</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%97%A0%E6%B3%95%E8%A7%A3%E5%8E%8Btar-gz%E6%96%87%E4%BB%B6%EF%BC%9F"><span class="toc-number">1.1.</span> <span class="toc-text">无法解压tar.gz文件？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#NodeManager%E5%90%AF%E5%8A%A8%E6%97%B6%E9%81%87%E5%88%B0%E9%94%99%E8%AF%AF"><span class="toc-number">1.2.</span> <span class="toc-text">NodeManager启动时遇到错误</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#pyspark%E6%8C%87%E4%BB%A4%E6%8A%A5%E9%94%99"><span class="toc-number">1.3.</span> <span class="toc-text">pyspark指令报错</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8D%A1%E5%9C%A8running-job%E5%90%8E%E4%B8%8D%E5%8A%A8%E4%BA%86"><span class="toc-number">1.4.</span> <span class="toc-text">卡在running job后不动了</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE"><span class="toc-number">2.</span> <span class="toc-text">环境配置</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#core-site-yml"><span class="toc-number">2.1.</span> <span class="toc-text">core-site.yml</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#hdfs-site-yml"><span class="toc-number">2.2.</span> <span class="toc-text">hdfs-site.yml</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#yarn-site"><span class="toc-number">2.3.</span> <span class="toc-text">yarn-site</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#mapred-site"><span class="toc-number">2.4.</span> <span class="toc-text">mapred-site</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E9%97%AE%E9%A2%98%E9%87%8D%E8%BF%B0"><span class="toc-number">3.</span> <span class="toc-text">问题重述</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%85%B7%E4%BD%93%E5%AE%9E%E7%8E%B0"><span class="toc-number">4.</span> <span class="toc-text">具体实现</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE1"><span class="toc-number">4.1.</span> <span class="toc-text">题目1</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%97%AE%E9%A2%981"><span class="toc-number">4.1.1.</span> <span class="toc-text">问题1</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%85%8D%E7%BD%AEpom"><span class="toc-number">4.1.1.1.</span> <span class="toc-text">配置pom</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BB%A3%E7%A0%81"><span class="toc-number">4.1.1.2.</span> <span class="toc-text">代码</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%97%AE%E9%A2%982"><span class="toc-number">4.1.2.</span> <span class="toc-text">问题2</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE2"><span class="toc-number">4.2.</span> <span class="toc-text">题目2</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%A3%E7%A0%81-1"><span class="toc-number">4.2.1.</span> <span class="toc-text">代码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%80%9D%E8%B7%AF"><span class="toc-number">4.2.2.</span> <span class="toc-text">思路</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE3"><span class="toc-number">4.3.</span> <span class="toc-text">题目3</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%A3%E7%A0%81-2"><span class="toc-number">4.3.1.</span> <span class="toc-text">代码</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%85%B7%E4%BD%93%E6%8C%87%E4%BB%A4"><span class="toc-number">5.</span> <span class="toc-text">具体指令</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%89%93%E5%BC%80hadoop"><span class="toc-number">5.1.</span> <span class="toc-text">打开hadoop</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#StuAvg"><span class="toc-number">5.2.</span> <span class="toc-text">StuAvg</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ClassAvg"><span class="toc-number">5.3.</span> <span class="toc-text">ClassAvg</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#GrandPC"><span class="toc-number">5.4.</span> <span class="toc-text">GrandPC</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Spark"><span class="toc-number">5.5.</span> <span class="toc-text">Spark</span></a></li></ol></li></ol>
                                  </div>
                              </button>
                          
                          
                      
                    
                      <a href="#nexmoe-content" class="toc-link" aria-label="回到顶部" title="top"><button class="mdui-fab mdui-ripple"><i class="nexmoefont icon-caret-top"></i></button></a>
                  </div>
              </div>
            </div>
        </div>
    </div>
    <script src="https://cdn.jsdelivr.net/combine/npm/lazysizes@5.1.0/lazysizes.min.js,npm/mdui@0.4.3/dist/js/mdui.min.js?v=1"></script>
<script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script>

 

<script async src="/js/app.js?v=1718334421766"></script>

<script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/js/jquery.justifiedGallery.min.js"></script>
<script>
	$(".justified-gallery").justifiedGallery({
		rowHeight: 160,
		margins: 10,
	});
</script>


    





</body>

</html>
