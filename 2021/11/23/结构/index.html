<!DOCTYPE html>

<html lang="zh-CN">

<head>
    
    <title>结构 - Amentiraz blog</title>
    <meta charset="UTF-8">
    <meta name="description" content="">
    <meta name="keywords" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5">
    
    

    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />
    <meta name="description" content="结构的基本知识结构是一个或者多个变量的几何，这些变量可能为不同的类型，为了处理的方便而将这些变量组织在一个名字之下。结构可以拷贝、赋值、传递给函数，函数也可以返回结构类型的返回值，在ANSI标准中，自动结构和数组现在也可以进行初始化。">
<meta property="og:type" content="article">
<meta property="og:title" content="结构">
<meta property="og:url" content="http://1152396492.github.io/2021/11/23/%E7%BB%93%E6%9E%84/index.html">
<meta property="og:site_name" content="Amentiraz blog">
<meta property="og:description" content="结构的基本知识结构是一个或者多个变量的几何，这些变量可能为不同的类型，为了处理的方便而将这些变量组织在一个名字之下。结构可以拷贝、赋值、传递给函数，函数也可以返回结构类型的返回值，在ANSI标准中，自动结构和数组现在也可以进行初始化。">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2021-11-22T21:02:31.000Z">
<meta property="article:modified_time" content="2023-11-14T01:53:21.931Z">
<meta property="article:author" content="Amentiraz">
<meta property="article:tag" content="C语言">
<meta property="article:tag" content="结构">
<meta name="twitter:card" content="summary">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/combine/npm/highlight.js@9.15.8/styles/atom-one-dark.css,npm/justifiedGallery@3.8.1/dist/css/justifiedGallery.min.css,gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css,npm/hexo-theme-nexmoe@latest/source/lib/mdui_043tiny/css/mdui.css,npm/hexo-theme-nexmoe@latest/source/lib/iconfont/iconfont.css?v=233" crossorigin>
    <link rel="stylesheet" href="/css/style.css?v=1717559894902">
    
    <link rel="stylesheet" href="/lib/iconfont/iconfont.css?v=1717559894902">
<meta name="generator" content="Hexo 6.0.0"><link rel="stylesheet" href="\assets\css\APlayer.min.css" class="aplayer-style-marker">
<script src="\assets\js\APlayer.min.js" class="aplayer-script-marker"></script>
<script src="\assets\js\Meting.min.js" class="meting-script-marker"></script>
</head>

<body class="mdui-drawer-body-left">
    
    <div id="nexmoe-background">
        <div class="nexmoe-bg" style="background-image: url(https://i.postimg.cc/XNHkwZh8/wallhaven-pkw6y3.jpg)"></div>
        <div class="mdui-appbar mdui-shadow-0">
            <div class="mdui-toolbar">
                <a mdui-drawer="{target: '#drawer', swipe: true}" title="menu" class="mdui-btn mdui-btn-icon mdui-ripple"><i class="mdui-icon nexmoefont icon-menu"></i></a>
                <div class="mdui-toolbar-spacer"></div>
                <!--<a href="javascript:;" class="mdui-btn mdui-btn-icon"><i class="mdui-icon material-icons">search</i></a>-->
                <a href="/" title="Amentiraz" class="mdui-btn mdui-btn-icon"><img src="https://i.postimg.cc/P5FyTCbJ/20220606230333.jpg" alt="Amentiraz"></a>
            </div>
        </div>
    </div>
    <div id="nexmoe-header">
        <div class="nexmoe-drawer mdui-drawer" id="drawer">
    <div class="nexmoe-avatar mdui-ripple">
        <a href="/" title="Amentiraz">
            <img src="https://i.postimg.cc/P5FyTCbJ/20220606230333.jpg" alt="Amentiraz" alt="Amentiraz">
        </a>
    </div>
    <div class="nexmoe-count">
        <div><span>文章</span>27</div>
        <div><span>标签</span>28</div>
        <div><span>分类</span>6</div>
    </div>
    <div class="nexmoe-list mdui-list" mdui-collapse="{accordion: true}">
        
        <a class="nexmoe-list-item mdui-list-item mdui-ripple false" href="/" title="回到首页">
            <i class="mdui-list-item-icon nexmoefont icon-home"></i>
            <div class="mdui-list-item-content">
                回到首页
            </div>
        </a>
        
        <a class="nexmoe-list-item mdui-list-item mdui-ripple false" href="/about.html" title="关于博客">
            <i class="mdui-list-item-icon nexmoefont icon-info-circle"></i>
            <div class="mdui-list-item-content">
                关于博客
            </div>
        </a>
        
        <a class="nexmoe-list-item mdui-list-item mdui-ripple false" href="/PY.html" title="我的朋友">
            <i class="mdui-list-item-icon nexmoefont icon-unorderedlist"></i>
            <div class="mdui-list-item-content">
                我的朋友
            </div>
        </a>
        
        <a class="nexmoe-list-item mdui-list-item mdui-ripple false" href="/archive.html" title="文章归档">
            <i class="mdui-list-item-icon nexmoefont icon-container"></i>
            <div class="mdui-list-item-content">
                文章归档
            </div>
        </a>
        
    </div>
    <aside id="nexmoe-sidebar">
    
    <div class="nexmoe-widget-wrap">
    <div class="nexmoe-widget nexmoe-search">
         
            <form id="search_form" action_e="https://cn.bing.com/search?q=site:nexmoe.com" onsubmit="return search();">
                <label><input id="search_value" name="q" type="search" placeholder="搜索"></label>
            </form>
         
    </div>
</div>
    
    <div class="nexmoe-widget-wrap">
    <div class="nexmoe-widget nexmoe-social">
        <a class="mdui-ripple" href="https://jq.qq.com/?_wv=1027&k=5CfKHun" target="_blank" mdui-tooltip="{content: 'QQ群'}" style="color: rgb(249, 174, 8);background-color: rgba(249, 174, 8, .1);">
            <i class="nexmoefont icon-QQ"></i>
        </a><a class="mdui-ripple" href="https://space.bilibili.com/20238211" target="_blank" mdui-tooltip="{content: '哔哩哔哩'}" style="color: rgb(231, 106, 141);background-color: rgba(231, 106, 141, .15);">
            <i class="nexmoefont icon-bilibili"></i>
        </a><a class="mdui-ripple" href="https://github.com/nexmoe/" target="_blank" mdui-tooltip="{content: 'GitHub'}" style="color: rgb(25, 23, 23);background-color: rgba(25, 23, 23, .15);">
            <i class="nexmoefont icon-github"></i>
        </a>
    </div>
</div>
    
    
  <div class="nexmoe-widget-wrap">
    <h3 class="nexmoe-widget-title">文章分类</h3>
    <div class="nexmoe-widget">

      <ul class="category-list">

        


        

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/代码/">代码</a>
          <span class="category-list-count">2</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/学习笔记/">学习笔记</a>
          <span class="category-list-count">5</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/数学建模/">数学建模</a>
          <span class="category-list-count">4</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/生活/">生活</a>
          <span class="category-list-count">8</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/算法/">算法</a>
          <span class="category-list-count">6</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/论文/">论文</a>
          <span class="category-list-count">1</span>
        </li>

        
      </ul>

    </div>
  </div>


    
    
  <div class="nexmoe-widget-wrap">
    <div id="randomtagcloud" class="nexmoe-widget tagcloud nexmoe-rainbow">
      <a href="/tags/C%E8%AF%AD%E8%A8%80/" style="font-size: 15px;">C语言</a> <a href="/tags/DP/" style="font-size: 10px;">DP</a> <a href="/tags/Dijkstra/" style="font-size: 10px;">Dijkstra</a> <a href="/tags/LCA/" style="font-size: 10px;">LCA</a> <a href="/tags/Matlab/" style="font-size: 10px;">Matlab</a> <a href="/tags/TOPSIS/" style="font-size: 12.5px;">TOPSIS</a> <a href="/tags/Tarjan/" style="font-size: 10px;">Tarjan</a> <a href="/tags/c%E8%AF%AD%E8%A8%80/" style="font-size: 10px;">c语言</a> <a href="/tags/python/" style="font-size: 10px;">python</a> <a href="/tags/%E4%B9%A6%E8%AF%84/" style="font-size: 15px;">书评</a> <a href="/tags/%E4%BB%A3%E7%A0%81/" style="font-size: 12.5px;">代码</a> <a href="/tags/%E5%88%86%E5%B8%83%E5%BC%8F/" style="font-size: 12.5px;">分布式</a> <a href="/tags/%E5%A4%8D%E4%B9%A0%E8%B5%84%E6%96%99/" style="font-size: 10px;">复习资料</a> <a href="/tags/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" style="font-size: 15px;">学习笔记</a> <a href="/tags/%E5%B1%82%E6%AC%A1%E5%88%86%E6%9E%90%E6%B3%95/" style="font-size: 10px;">层次分析法</a> <a href="/tags/%E6%8C%87%E9%92%88/" style="font-size: 10px;">指针</a> <a href="/tags/%E6%8F%92%E5%80%BC%E7%AE%97%E6%B3%95/" style="font-size: 10px;">插值算法</a> <a href="/tags/%E6%95%B0%E5%AD%A6%E5%BB%BA%E6%A8%A1/" style="font-size: 17.5px;">数学建模</a> <a href="/tags/%E6%9D%82/" style="font-size: 10px;">杂</a> <a href="/tags/%E7%94%9F%E6%B4%BB/" style="font-size: 17.5px;">生活</a> <a href="/tags/%E7%AC%94%E8%AE%B0/" style="font-size: 10px;">笔记</a> <a href="/tags/%E7%AE%97%E6%B3%95/" style="font-size: 20px;">算法</a> <a href="/tags/%E7%BA%BF%E6%AE%B5%E6%A0%91/" style="font-size: 10px;">线段树</a> <a href="/tags/%E7%BB%93%E6%9E%84/" style="font-size: 10px;">结构</a> <a href="/tags/%E8%AE%BA%E6%96%87/" style="font-size: 10px;">论文</a> <a href="/tags/%E8%AF%97/" style="font-size: 10px;">诗</a> <a href="/tags/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/" style="font-size: 10px;">读书笔记</a> <a href="/tags/%E9%A2%98%E8%A7%A3/" style="font-size: 10px;">题解</a>
    </div>
    
  </div>

    
</aside>
    <div class="nexmoe-copyright">
        &copy; 2024 Amentiraz
        Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
        & <a href="https://github.com/theme-nexmoe/hexo-theme-nexmoe" target="_blank">Nexmoe</a>
        <br><a target="_blank" href="https://www.upyun.com/?utm_source=lianmeng&utm_medium=referral"><img src="https://i.dawnlab.me/c0268c1e6cfd0863d6ba35be1575941a.png" width="150px"></a><script data-ad-client="ca-pub-2058306854838448" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    </div>
</div><!-- .nexmoe-drawer -->
    </div>
    <div id="nexmoe-content">
        <div class="nexmoe-primary">
            <div class="nexmoe-post">

  <article>
      
          <div class="nexmoe-post-cover" style="padding-bottom: NaN%;"> 
              <img data-src="https://tva1.sinaimg.cn/large/008i3skNly1gwsdt2024tj30xc0nkgvs.jpg" data-sizes="auto" alt="结构" class="lazyload">
              <h1>结构</h1>
          </div>
      
      
      <div class="nexmoe-post-meta nexmoe-rainbow" style="margin:10px 0!important;">
    <a><i class="nexmoefont icon-calendar-fill"></i>2021年11月22日</a>
    <a><i class="nexmoefont icon-areachart"></i>3k 字</a>
    <a><i class="nexmoefont icon-time-circle-fill"></i>大概 13 分钟</a>
</div>

      

      
    <div id="aplayer-QFSBiHmm" class="aplayer aplayer-tag-marker meting-tag-marker"
         data-id="29393038" data-server="netease" data-type="song" data-mode="circulation" data-autoplay="true" data-mutex="true" data-listmaxheight="340px" data-preload="none" data-theme="#ad7a86"
    ></div>
<h3 id="结构的基本知识"><a href="#结构的基本知识" class="headerlink" title="结构的基本知识"></a>结构的基本知识</h3><p>结构是一个或者多个变量的几何，这些变量可能为不同的类型，为了处理的方便而将这些变量组织在一个名字之下。<br>结构可以拷贝、赋值、传递给函数，函数也可以返回结构类型的返回值，在ANSI标准中，自动结构和数组现在也可以进行初始化。</p>
<span id="more"></span>
<p>我们首先来看一个关于平面坐标的结构体</p>
<figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs arduino"><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">point</span> &#123;</span><br>    <span class="hljs-keyword">int</span> x , y ; <br>&#125; ; <br></code></pre></td></tr></table></figure>
<p>关键字struct引入结构声明。结构声明由包含在花括号内的一系列声明组成。关键字struct后面的名字是可选的，称为<em>结构标记</em>（这里是point）。<br>结构标记用于为结构命名，在定义之后，结构标记就代表花括号内的声明，可以用它作为该声明的简写形式。<br>结构中定义的变量称为<em>成员</em>。结构成员，结构标记和普通变量（即非成员）可以采用相同的名字，它们之间不会冲突，因为通过上下文分析总可以对它们进行区分。不同结构中的成员也可以使用相同的名字。<br>struct声明定义了一种数据类型，在标志结构成员表结束的右花括号之后可以跟一个变量表，这与其它基本类型的变量声明是相同的。例如：</p>
<figure class="highlight gauss"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gauss"><span class="hljs-keyword">struct</span> &#123; ... &#125; x , y , z ; <br></code></pre></td></tr></table></figure>
<p>从语法角度来说，这种声明与声明</p>
<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs angelscript"><span class="hljs-built_in">int</span> x , y , z ; <br></code></pre></td></tr></table></figure>
<p>具有类似的意义。如果结构声明的后面不带变量表，则不需要为它分配存储空间，它仅仅描述了一个结构的模版。但是，如果结构声明中带有标记，那么在以后定义结构实例时便可以使用该标记定义。例如：</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">struct</span> point maxpt = &#123; <span class="hljs-number">320</span> , <span class="hljs-number">200</span> &#125; ; <br></code></pre></td></tr></table></figure>
<p>定义了一个struct point类型的变量pt。结构的初始化可以在定义的后面使用初值表进行，除指标中同每个成员对应的处置必须是常量表达式。<br>自动结构也可以通过赋值初始化，还可以通过调用返回相应类型结构中的成员。<br>在表达式中可以通过下列形式引用某哥特定结构中的成员：<br>结构名.成员<br>结构可以嵌套，例如</p>
<figure class="highlight gauss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs gauss"><span class="hljs-keyword">struct</span> <span class="hljs-type">rect</span> &#123; <br>    <span class="hljs-keyword">struct</span> <span class="hljs-type">point</span> pt1 ; <br>    <span class="hljs-keyword">struct</span> <span class="hljs-type">point</span> pt2 ; <br>&#125; ;<br><span class="hljs-keyword">struct</span> <span class="hljs-type">rec</span> <span class="hljs-keyword">screen</span> ; <br></code></pre></td></tr></table></figure>
<p>我们可以使用语句</p>
<figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs abnf">screen.pt1.x <span class="hljs-comment">; </span><br></code></pre></td></tr></table></figure>
<h3 id="结构与函数"><a href="#结构与函数" class="headerlink" title="结构与函数"></a>结构与函数</h3><p>结构的合法操作只有：</p>
<ol>
<li>作为一个整体赋值</li>
<li>通过&amp;运算符取地址，访问其成员。</li>
</ol>
<p>其中复制和复制包括向函数传递参数以及从函数返回值。结构之间不可以进行比较。<br>可以用一个常量成员值列表初始化结构，自动结构也可以通过赋值进行初始化。<br>我们可以通过至少3种方法传递结构：</p>
<ol>
<li>分别传递各个结构成员</li>
<li>传递整个结构</li>
<li>传递指向结构的指针</li>
</ol>
<p>例如以下函数</p>
<figure class="highlight gauss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs gauss"><span class="hljs-keyword">struct</span> <span class="hljs-type">point</span> <span class="hljs-built_in">makepoint</span> ( int x , int y ) &#123;<br>    <span class="hljs-keyword">struct</span> <span class="hljs-type">point</span> temp ; <br>    temp.x = x ; temp.y = y ; <br>    <span class="hljs-keyword">return</span> temp ; <br>&#125;<br><br><span class="hljs-keyword">struct</span> <span class="hljs-type">rect</span> <span class="hljs-keyword">screen</span> ; <br><span class="hljs-keyword">struct</span> <span class="hljs-type">point</span> middle ; <br><span class="hljs-keyword">struct</span> <span class="hljs-type">point</span> <span class="hljs-built_in">makepoint</span> ( int , int ) ; <br>screen.pt1 = <span class="hljs-built_in">makepoint</span> ( <span class="hljs-number">0</span> , <span class="hljs-number">0</span> ) ; <br>screen.pt2 = <span class="hljs-built_in">makepoint</span> ( XMAX , YMAX ) ; <br>middle = <span class="hljs-built_in">makepoint</span> ( ( screen.pt1.x + screen.pt2.x ) &gt;&gt; <span class="hljs-number">1</span> , ( screen.pt1.y + screen.pt2.y ) &gt;&gt; <span class="hljs-number">1</span> ) ; <br><br><span class="hljs-keyword">struct</span> <span class="hljs-type">point</span> <span class="hljs-built_in">addpoint</span> ( <span class="hljs-keyword">struct</span> <span class="hljs-type">point</span> p1 , <span class="hljs-keyword">struct</span> <span class="hljs-type">point</span> p2 ) &#123; <br>    p1.x += p2.x ; <br>    p1.y += p2.y ; <br>    <span class="hljs-keyword">return</span> p1 ; <br>&#125;   <br></code></pre></td></tr></table></figure>
<p>addpoint 函数的参数和返回值都是结构类型，结构类型的参数和其它参数是一样的都是通过值传递的。</p>
<p>如果传递给函数的结构很大，使用指针方式的效率通常比赋值整个结构的效率更高，结构指针类似于普通变量指针。声明：</p>
<figure class="highlight gauss"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gauss"><span class="hljs-keyword">struct</span> <span class="hljs-type">point</span> * pp ; <br></code></pre></td></tr></table></figure>
<p>如果pp指向一个point结构，那么 * pp 即为该结构，而（ * pp ).x 和( * pp ).y则是结构成员。其中( * pp ).x 的圆括号是必须的，因为结构成员运算符”.”的优先级比”*“的优先级高。表达式*pp.x的含义等价于*(pp.x)，因为x不是指针，所以该表达式是非法的。<br>结构指针的使用频率非常高，为了使用方便，C语言提供了另一种简写方式。嘉定p是一个指向结构的指针，可以用<br>p-&gt;结构成员<br>这种形式来引用相应的结构成员。<br>运算符.和-&gt;都是从左至右结合的，所以以下声明都是等价的：</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs powershell">struct rec <span class="hljs-built_in">r</span> , * <span class="hljs-built_in">rp</span> = &amp; <span class="hljs-built_in">r</span> ; <br><br>r.pt1.x <br><span class="hljs-built_in">rp</span>-&gt;pt1.x <br>(r.pt1).x <br>(<span class="hljs-built_in">rp</span>-&gt;pt1).x<br></code></pre></td></tr></table></figure>
<p>在所有运算符中，下面 4 个运算符的优先级最高：结构运算符“.”和“-&gt;”、用于函数<br>调用的“()”以及用于下标的“[]”，因此，它们同操作数之间的结合也最紧密。例如，对于<br>结构声明</p>
<figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs abnf">struct &#123; <br>    int len<span class="hljs-comment">; </span><br>    char *str<span class="hljs-comment">; </span><br>&#125; *p <span class="hljs-comment">;</span><br></code></pre></td></tr></table></figure>
<p>表达式</p>
<figure class="highlight xl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xl">++<span class="hljs-function"><span class="hljs-title">p</span>-&gt;</span>len<br></code></pre></td></tr></table></figure>
<p>将增加 len 的值，而不是增加 p 的值，这是田为，其中的隐含括号关系是++(p-&gt;len)。可 以使用括号改变结合次序。例如：(++p)-&gt;len 将先执行 p 的加 1 操作，再对 len 执行操作； 而(p++)-&gt;len 则先对 len 执行操作，然后再将 p 加 1（该表达式中的括号可以省略）。 同样的道理，*p-&gt;str 读取的是指针 str 所指向的对象的值；*p-&gt;str++先读取指针str 指向的对象的值，然后再将 str 加 1（与*s++相同）；(*p-&gt;str）++将指针 str 指向 的对象的值加 1；*p++-&gt;str 先读取指针 str 指向的对象的值，然后再将 p 加 1。</p>
<h3 id="结构数组"><a href="#结构数组" class="headerlink" title="结构数组"></a>结构数组</h3><p>考虑编写一个程序，用来统计输入中各个C语言关键字出现的次数。</p>
<figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs arduino"><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">key</span> &#123;</span><br>    <span class="hljs-keyword">char</span> *<span class="hljs-keyword">word</span>;<br>    <span class="hljs-keyword">int</span> count;<br>&#125; keytab[] = &#123;<br>    <span class="hljs-string">&quot;auto&quot;</span>, <span class="hljs-number">0</span>,<br>    <span class="hljs-string">&quot;break&quot;</span>, <span class="hljs-number">0</span>,<br>    <span class="hljs-string">&quot;case&quot;</span>, <span class="hljs-number">0</span>,<br>    <span class="hljs-string">&quot;char&quot;</span>, <span class="hljs-number">0</span>,<br>    <span class="hljs-string">&quot;const&quot;</span>, <span class="hljs-number">0</span>,<br>    <span class="hljs-string">&quot;continue&quot;</span>, <span class="hljs-number">0</span>,<br>    <span class="hljs-string">&quot;default&quot;</span>, <span class="hljs-number">0</span>,<br>    <span class="hljs-comment">/* ... */</span><br>    <span class="hljs-string">&quot;unsigned&quot;</span>, <span class="hljs-number">0</span>,<br>    <span class="hljs-string">&quot;void&quot;</span>, <span class="hljs-number">0</span>,<br>    <span class="hljs-string">&quot;volatile&quot;</span>, <span class="hljs-number">0</span>,<br>    <span class="hljs-string">&quot;while&quot;</span>, <span class="hljs-number">0</span><br>&#125;;<br></code></pre></td></tr></table></figure>
<p>与结构成员相对应，初值也要按照成对的方式列出。更精确的做法是，将每一行（即每个结<br>构）的初值都括在花括号内，如下所示：</p>
<figure class="highlight erlang"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs erlang">&#123; <span class="hljs-string">&quot;auto&quot;</span>, <span class="hljs-number">0</span> &#125;, <br>&#123; <span class="hljs-string">&quot;break&quot;</span>, <span class="hljs-number">0</span> &#125;, <br>&#123; <span class="hljs-string">&quot;case&quot;</span>, <span class="hljs-number">0</span> &#125;, <br>...<br></code></pre></td></tr></table></figure>
<p>但是，如果初值是简单变量或字符串，并且其中的任何值都不为空，则内层的花括号可以省 略。通常情况下，如果初值存在并且方括号[ ]中没有数值，编译程序将计算数组 keytab 中 的项数。<br>在统计关键字出现次数的程序中，我们首先定义了 keytab。主程序反复调用函数getword 读取输入，每次读取一个单词。每个单词将通过折半查找函数在keytab 中进行查找。注意，关键字列表必须按升序存储在 keytab 中。</p>
<figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><code class="hljs arduino"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;ctype.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;string.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> MAXWORD 100</span><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">getword</span><span class="hljs-params">(<span class="hljs-keyword">char</span> *, <span class="hljs-keyword">int</span>)</span></span>;<br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">binsearch</span><span class="hljs-params">(<span class="hljs-keyword">char</span> *, struct key *, <span class="hljs-keyword">int</span>)</span></span>;<br><span class="hljs-comment">/* count C keywords */</span><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">int</span> n;<br>    <span class="hljs-keyword">char</span> <span class="hljs-keyword">word</span>[MAXWORD];<br>    <span class="hljs-keyword">while</span> (<span class="hljs-built_in">getword</span>(<span class="hljs-keyword">word</span>, MAXWORD) != EOF)<br>        <span class="hljs-keyword">if</span> (<span class="hljs-built_in">isalpha</span>(<span class="hljs-keyword">word</span>[<span class="hljs-number">0</span>]))<br>              <span class="hljs-keyword">if</span> ((n = <span class="hljs-built_in">binsearch</span>(<span class="hljs-keyword">word</span>, keytab, NKEYS)) &gt;= <span class="hljs-number">0</span>)<br>                    keytab[n].count++;<br>    <span class="hljs-keyword">for</span> (n = <span class="hljs-number">0</span>; n &lt; NKEYS; n++)<br>        <span class="hljs-keyword">if</span> (keytab[n].count &gt; <span class="hljs-number">0</span>)<br>            <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%4d %s\n&quot;</span>,<br>                keytab[n].count, keytab[n].<span class="hljs-keyword">word</span>);<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br><span class="hljs-comment">/* binsearch: find word in tab[0]...tab[n-1] */</span><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">binsearch</span><span class="hljs-params">(<span class="hljs-keyword">char</span> *<span class="hljs-keyword">word</span>, struct key tab[], <span class="hljs-keyword">int</span> n)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">int</span> cond;<br>    <span class="hljs-keyword">int</span> low, high, mid;<br>    low = <span class="hljs-number">0</span>;<br>    high = n - <span class="hljs-number">1</span>;<br>    <span class="hljs-keyword">while</span> (low &lt;= high) &#123;<br>        mid = (low+high) / <span class="hljs-number">2</span>;<br>        <span class="hljs-keyword">if</span> ((cond = <span class="hljs-built_in">strcmp</span>(<span class="hljs-keyword">word</span>, tab[mid].<span class="hljs-keyword">word</span>)) &lt; <span class="hljs-number">0</span>)<br>            high = mid - <span class="hljs-number">1</span>;<br>        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (cond &gt; <span class="hljs-number">0</span>)<br>            low = mid + <span class="hljs-number">1</span>;<br>        <span class="hljs-keyword">else</span><br>            <span class="hljs-keyword">return</span> mid;<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>;<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">getword</span> <span class="hljs-params">( <span class="hljs-keyword">char</span> * <span class="hljs-keyword">word</span> , <span class="hljs-keyword">int</span> lim )</span> </span>&#123;<br>    <span class="hljs-keyword">int</span> c , <span class="hljs-built_in">getch</span> ( <span class="hljs-keyword">void</span> ) ; <br>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">ungetch</span> <span class="hljs-params">( <span class="hljs-keyword">int</span> )</span> </span>; <br>    <span class="hljs-keyword">char</span> * w = <span class="hljs-keyword">word</span> ; <br>    <span class="hljs-keyword">while</span> ( <span class="hljs-built_in">isspace</span> ( c = <span class="hljs-built_in">getch</span> ( ) ) ) ; <br>    <span class="hljs-keyword">if</span> ( c != EOF ) * w ++ ; <br>    <span class="hljs-keyword">if</span> ( ! <span class="hljs-built_in">isalpha</span> ( c ) ) &#123; * w = <span class="hljs-string">&#x27;\0&#x27;</span> ; <span class="hljs-keyword">return</span> c ; &#125; <br>    <span class="hljs-keyword">for</span> ( ; -- lim &gt; <span class="hljs-number">0</span> ; w ++ ) <br>        <span class="hljs-keyword">if</span> ( ! <span class="hljs-built_in">isnum</span> ( * w = <span class="hljs-built_in">getch</span> ( ) ) ) &#123;<br>            <span class="hljs-built_in">ungetch</span> ( * w ) ; <span class="hljs-keyword">break</span> ; <br>        &#125;<br>    * w = <span class="hljs-string">&#x27;\0&#x27;</span> ; <br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">word</span>[<span class="hljs-number">0</span>] ; <br>&#125;<br><span class="hljs-comment">/*我们可以通过如下方法计算NKEYS的值*/</span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> NKEYS ( sizeof keytab / sizeof ( struct key ) ) </span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> NKEYS ( sizeof keytab / sizeof keytab[0] ) </span><br></code></pre></td></tr></table></figure>
<p>getchar函数的返回值也是int类型的</p>
<h3 id="指向结构的指针"><a href="#指向结构的指针" class="headerlink" title="指向结构的指针"></a>指向结构的指针</h3><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs arduino"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdio.h&gt;</span> </span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;ctype.h&gt;</span> </span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;string.h&gt;</span> </span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> MAXWORD 100 </span><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">getword</span><span class="hljs-params">(<span class="hljs-keyword">char</span> *, <span class="hljs-keyword">int</span>)</span></span>; <br><span class="hljs-function">struct key *<span class="hljs-title">binsearch</span><span class="hljs-params">(<span class="hljs-keyword">char</span> *, struct key *, <span class="hljs-keyword">int</span>)</span></span>; <br><span class="hljs-comment">/* count C keywords; pointer version */</span> <br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span><br><span class="hljs-function"></span>&#123; <br>    <span class="hljs-keyword">char</span> <span class="hljs-keyword">word</span>[MAXWORD]; <br>    <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">key</span> *<span class="hljs-title">p</span>;</span> <br>    <span class="hljs-keyword">while</span> (<span class="hljs-built_in">getword</span>(<span class="hljs-keyword">word</span>, MAXWORD) != EOF) <br>        <span class="hljs-keyword">if</span> (<span class="hljs-built_in">isalpha</span>(<span class="hljs-keyword">word</span>[<span class="hljs-number">0</span>])) <br>            <span class="hljs-keyword">if</span> ((p=<span class="hljs-built_in">binsearch</span>(<span class="hljs-keyword">word</span>, keytab, NKEYS)) != <span class="hljs-literal">NULL</span>) <br>                p-&gt;count++; <br>    <span class="hljs-keyword">for</span> (p = keytab; p &lt; keytab + NKEYS; p++) <br>        <span class="hljs-keyword">if</span> (p-&gt;count &gt; <span class="hljs-number">0</span>) <br>            <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%4d %s\n&quot;</span>, p-&gt;count, p-&gt;<span class="hljs-keyword">word</span>); <br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>; <br>&#125; <br><span class="hljs-comment">/* binsearch: find word in tab[0]...tab[n-1] */</span> <br><span class="hljs-function">struct key *<span class="hljs-title">binsearch</span><span class="hljs-params">(<span class="hljs-keyword">char</span> *<span class="hljs-keyword">word</span>, struck key *tab, <span class="hljs-keyword">int</span> n)</span> </span><br><span class="hljs-function"></span>&#123; <br>    <span class="hljs-keyword">int</span> cond; <br>    <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">key</span> *<span class="hljs-title">low</span> =</span> &amp;tab[<span class="hljs-number">0</span>]; <br>    <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">key</span> *<span class="hljs-title">high</span> =</span> &amp;tab[n]; <br>    <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">key</span> *<span class="hljs-title">mid</span>;</span> <br>    <span class="hljs-keyword">while</span> (low &lt; high) &#123; <br>        mid = low + (high-low) / <span class="hljs-number">2</span>; <br>        <span class="hljs-keyword">if</span> ((cond = <span class="hljs-built_in">strcmp</span>(<span class="hljs-keyword">word</span>, mid-&gt;<span class="hljs-keyword">word</span>)) &lt; <span class="hljs-number">0</span>) <br>            high = mid; <br>        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (cond &gt; <span class="hljs-number">0</span>) <br>            low = mid + <span class="hljs-number">1</span>; <br>        <span class="hljs-keyword">else</span> <br>            <span class="hljs-keyword">return</span> mid; <br>    &#125; <br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">NULL</span>; <br>&#125;<br></code></pre></td></tr></table></figure>
<p>这一个部分比较简单，就不细写了，上面的程序等于是改写了一下。搜索函数里面的while循环是为了防止死循环写的，当high&#x3D;&#x3D;low的时候，如果没有low&lt;high这个条件会一直死循环下去。<br>特别需要注意的是千万不要认为结构的长度等于各成员长度的和。因为不同的对象有不同的对齐要 求，所以，结构中可能会出现未命名的“空穴“（hole）。例如，假设 char 类型占用一个字节，int 类型占用 4 个字节，则下列结构：</p>
<figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs abnf">struct &#123; <br>    char c<span class="hljs-comment">; </span><br>    int i<span class="hljs-comment">; </span><br>&#125;<span class="hljs-comment">; </span><br></code></pre></td></tr></table></figure>
<p>可能需要 8 个字节的存储空间，而不是 5 个字节。使用 sizeof 运算符可以返回正确的对象<br>长度。</p>
<h3 id="自引用结构"><a href="#自引用结构" class="headerlink" title="自引用结构"></a>自引用结构</h3><p>假定我们需要处理一个更一般化的问题：统计输入中所有单词的出现次数。因为预先不 知道出现的单词列表，所以无法方便地排序，并使用折半查找；也不能分别对输入中的每个单词都执行一次线性查找，看它在前面是否已经出现，这样做，程序的执行将花费太长的时 间。（更准确地说，程序的执行时间是与输入单词数目的二次方成比例的。）我们该如何组织这些数据，才能够有效地处理一系列任意的单词呢？<br>一种解决方法是，在读取输入中任意单词的同时，就将它放置到正确的位置，从而始终 保证所有单词是按顺序排列的。虽然这可以不用通过在线性数组中移动单词来实现，但它仍 然会导致程序执行的时间过长。我们可以使用一种称为二叉树的数据结构来取而代之。 每个不同的单词在树中都是一个节点，每个节点包含： </p>
<ol>
<li>一个指向该单词内容的指针</li>
<li>一个统计出现次数的计数值 · 一个指向左子树的指针</li>
<li>一个指向右子树的指针<br>任何节点最多拥有两个子树，也可能只有一个子树或一个都没有。 对节点的所有操作要保证，任何节点的左子树只包含按字典序小于该节点中单词的那些单词，右子树只包含按字典序大于该节点中单词的那些单词。要查找一个新单词是否已经在树中，可以从根节点开始，比较新单词与该节点中的单词。若 匹配，则得到肯定的答案。若新单词小于该节点中的单词，则在左子树中继续查找，否则在 右子树中查找。如在搜寻方向上无子树，则说明新单词不在树中，并且，当前的空位置就是 存放新加入单词的正确位置。因为从任意节点出发的查找都要按照同样的方式查找它的一个子树，所以该过程是递归的。相应地，在插入和打印操作中使用递归过程也是很自然的事情。<br>对节点的递归的：</li>
</ol>

  </article>

  
  
  <div class="nexmoe-post-meta nexmoe-rainbow">
    
        <a class="nexmoefont icon-appstore-fill -link" href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/">学习笔记</a>
    
    
        <a class="nexmoefont icon-tag-fill -none-link" href="/tags/C%E8%AF%AD%E8%A8%80/" rel="tag">C语言</a> <a class="nexmoefont icon-tag-fill -none-link" href="/tags/%E7%BB%93%E6%9E%84/" rel="tag">结构</a>
    
</div>

  
      <div class="nexmoe-post-footer">
          <section class="nexmoe-comment">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@latest/dist/gitalk.min.css">
<div id="gitalk"></div>
<script src="https://cdn.jsdelivr.net/npm/gitalk@latest/dist/gitalk.min.js"></script>
<script type="text/javascript">
    var gitalk = new Gitalk({
        clientID: 'd792bb4144ed2b426d10',
        clientSecret: '812d33a3a53d9f83437ed1e71c573a8b222a93f1',
        id: window.location.pathname,
        repo: '1152396492.github.io',
        owner: '1152396492',
        admin: '1152396492'
    })
    gitalk.render('gitalk')
</script>
</section>
      </div>
  
</div>
            <div class="nexmoe-post-right">
              <div class="nexmoe-fixed">
                  <div class="nexmoe-tool"> 
                    
                      
                        
                          
                          
                              <button class="mdui-fab catalog" style="overflow:unset;">
                                  <i class="nexmoefont icon-i-catalog"></i>
                                  <div class="nexmoe-toc">
                                      <ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%93%E6%9E%84%E7%9A%84%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86"><span class="toc-number">1.</span> <span class="toc-text">结构的基本知识</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%93%E6%9E%84%E4%B8%8E%E5%87%BD%E6%95%B0"><span class="toc-number">2.</span> <span class="toc-text">结构与函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%93%E6%9E%84%E6%95%B0%E7%BB%84"><span class="toc-number">3.</span> <span class="toc-text">结构数组</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8C%87%E5%90%91%E7%BB%93%E6%9E%84%E7%9A%84%E6%8C%87%E9%92%88"><span class="toc-number">4.</span> <span class="toc-text">指向结构的指针</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%87%AA%E5%BC%95%E7%94%A8%E7%BB%93%E6%9E%84"><span class="toc-number">5.</span> <span class="toc-text">自引用结构</span></a></li></ol>
                                  </div>
                              </button>
                          
                          
                      
                    
                      <a href="#nexmoe-content" class="toc-link" aria-label="回到顶部" title="top"><button class="mdui-fab mdui-ripple"><i class="nexmoefont icon-caret-top"></i></button></a>
                  </div>
              </div>
            </div>
        </div>
    </div>
    <script src="https://cdn.jsdelivr.net/combine/npm/lazysizes@5.1.0/lazysizes.min.js,npm/mdui@0.4.3/dist/js/mdui.min.js?v=1"></script>
<script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script>

 

<script async src="/js/app.js?v=1717559894905"></script>

<script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/js/jquery.justifiedGallery.min.js"></script>
<script>
	$(".justified-gallery").justifiedGallery({
		rowHeight: 160,
		margins: 10,
	});
</script>


    





</body>

</html>
